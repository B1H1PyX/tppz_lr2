# Інструкція з оновлення проекту

Цей документ описує процедуру оновлення коду статичного сайту на production-сервері.

## 1. Підготовка до оновлення

1.  **Повідомте користувачів** (якщо такі є) про можливі короткочасні перерви в роботі сайту. Для статичного сайту downtime практично непомітний.
2.  **Увійдіть на сервер** через SSH.
3.  **Перейдіть в директорію з проектом:**
    ```bash
    cd /var/www/bachelor-work
    ```

## 2. Створення резервних копій

1.  **Створіть резервну копію поточної версії сайту:**
    ```bash
    sudo cp -r html html-backup-$(date +%Y%m%d_%H%M%S)
    ```
    Це створить копію папки `html` з часовою міткою, наприклад, `html-backup-20231027_143000`.

## 3. Перевірка сумісності

Оскільки проект статичний, основна сумісність залежить від браузера клієнта. Зазвичай, нові зміни не ламають стару версію, але якщо ви вносили кардинальні зміни у структуру HTML, перевірте їх на тестовому сервері перед оновленням продакшену.

## 4. Планування часу простою

Для оновлення статичного сайту **не потрібен запланований простій**. Процес займає лічені секунди. Можна виконувати оновлення в будь-який час.

## 5. Процес оновлення

1.  **Отримайте свіжий код з Git (найпростіший спосіб)**
    ```bash
    # Тимчасово скопіюйте старий код, якщо ви не зробили це на кроці 2
    # sudo cp -r html html-backup

    # Очистіть поточну папку html (але не саму папку!)
    sudo rm -rf /var/www/bachelor-work/html/*

    # Склонуйте нову версію в тимчасову папку
    git clone https://github.com/B1H1PyX/tppz_lr2.git /tmp/bachelor-project-new

    # Скопіюйте нові файли
    sudo cp -r /tmp/bachelor-project-new/* /var/www/bachelor-work/html/
    sudo cp -r /tmp/bachelor-project-new/.[!.]* /var/www/bachelor-work/html/ 2>/dev/null

    # Видаліть тимчасову папку
    rm -rf /tmp/bachelor-project-new

    # Встановіть правильні права
    sudo chown -R www-data:www-data /var/www/bachelor-work/html
    ```

2.  **Альтернатива: Використання `rsync` для швидшого оновлення**
    Якщо ви часто оновлюєте код, `rsync` копіює тільки змінені файли.
    ```bash
    git clone https://github.com/B1H1PyX/tppz_lr2.git /tmp/bachelor-project-new
    sudo rsync -av --delete /tmp/bachelor-project-new/ /var/www/bachelor-work/html/
    sudo chown -R www-data:www-data /var/www/bachelor-work/html
    rm -rf /tmp/bachelor-project-new
    ```

3.  **Зупинка служб**
    Не потрібно. Веб-сервер продовжить працювати, віддаючи старі файли, поки ви їх не перезапишете. В момент перезапису нові відвідувачі отримають нові файли.

## 6. Перевірка після оновлення

1.  Відкрийте сайт у браузері.
2.  Оновіть сторінку (Ctrl+F5), щоб скинути кеш браузера.
3.  Візуально перевірте, чи всі елементи відображаються коректно.
4.  Перевірте консоль браузера на наявність помилок (F12 -> Console).

## 7. Процедура відкату (Rollback)

Якщо після оновлення виявилися критичні проблеми:

1.  **Поверніть резервну копію:**
    ```bash
    # Видаліть поточну (невдалу) версію
    sudo rm -rf /var/www/bachelor-work/html

    # Відновіть з останньої резервної копії
    # Знайдіть назву вашої останньої копії
    ls -la /var/www/bachelor-work/ | grep html-backup

    # Припустимо, копія називається html-backup-20231027_143000
    sudo cp -r /var/www/bachelor-work/html-backup-20231027_143000 /var/www/bachelor-work/html

    # Встановіть правильні права
    sudo chown -R www-data:www-data /var/www/bachelor-work/html
    ```
2.  **Перевірте**, чи сайт знову працює.
3.  **Проаналізуйте** причину невдалого оновлення та виправте її в коді.